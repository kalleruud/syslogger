services:
  syslogger:
    image: ghcr.io/kalleruud/syslogger:latest
    container_name: syslogger
    restart: unless-stopped
    environment:
      # HTTP server configuration
      SYSLOGGER_PORT: 3791

      # Syslog UDP configuration
      SYSLOGGER_SYSLOG_PORT: 5140
      SYSLOGGER_SYSLOG_PROTOCOL: udp

      # Database configuration
      SYSLOGGER_DB_URL: ./data/db/syslogger.db

      # Timezone configuration (adjust as needed)
      TZ: UTC
    ports:
      - "3791:3791"
      - "5140:5140/udp"
    volumes:
      - ./data:/usr/src/app/data
    healthcheck:
      test:
        [
          "CMD",
          "bun",
          "-e",
          "fetch('http://127.0.0.1:3791/').then(() => process.exit(0)).catch(() => process.exit(1))",
        ]
      interval: 30s
      timeout: 10s
      start_period: 5s
      retries: 3
